<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__text">
                    <h4>Check Out</h4>
                    <div class="breadcrumb__links">
                        <a href="/">Home</a>
                        <a href="./shop.html">Shop</a>
                        <span>Check Out</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->

<!-- Checkout Section Begin -->
<section class="checkout spad">
    <div class="container">
        <div class="checkout__form">
            <form action="" method="post" id="checkoutForm" >
                <div class="row">
                    <div class="col-lg-8 col-md-6">
                        <h6 class="checkout__title">Billing Details</h6>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Fist Name<span>*</span></p>
                                    <input type="text" name="userId" value="{{user._id}}" hidden>
                                    <input type="text" name="firstName" id="firstName" required>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Last Name<span>*</span></p>
                                    <input type="text" name="lastName" id="lastName" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Phone<span>*</span></p>
                                    <input type="text" name="phone" id="phone" required>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Email<span>*</span></p>
                                    <input type="text" name="email" id="email" required>
                                </div>
                            </div>
                        </div>
                        <div class="checkout__input">
                            <p>Country<span>*</span></p>
                            <input type="text" name="country" id="country" required>
                        </div>
                        <div class="checkout__input">
                            <p>Address<span>*</span></p>
                            <input type="text" name="addressLineOne" id="addressLineOne" placeholder="Street Address"
                                class="checkout__input__add" required>
                            <input type="text" name="addressLineTwo" id="addressLineTwo"
                                placeholder="Apartment, suite, unite ect (optinal)" required>
                        </div>
                        <div class="checkout__input">
                            <p>Town/City<span>*</span></p>
                            <input type="text" name="town" id="town" required>
                        </div>
                        <div class="checkout__input">
                            <p>State<span>*</span></p>
                            <input type="text" name="state" id="state" required>
                        </div>
                        <div class="checkout__input">
                            <p>Postcode / ZIP<span>*</span></p>
                            <input type="text" name="postcode" id="postcode" required>
                        </div>

                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="checkout__order">
                            <h4 class="order__title">Your order</h4>
                            <div class="checkout__order__products">Product <span>Total</span></div>
                            {{#each products}}
                            <ul class="checkout__total__products">
                                
                                <li>{{this.product.name}}<span>₹{{this.product.price}}</span></li>
                                
                            </ul>
                            {{/each}}
                            <ul class="checkout__total__all">
                                <li>Subtotal <span>₹ {{total}}</span></li>
                                <li>Total <span>₹ {{total}}</span></li>
                            </ul>
                            
                            <div class="form-check checkout__input__checkbox">
                                <input class="form-check-input" type="radio" name="paymentMethod"
                                    value="cashOnDelivery">
                                <label class="form-check-label" for="cashOnDelivery">
                                    Cash on Delivery
                                </label>
                            </div>
                            <div class="form-check checkout__input__checkbox">
                                <input class="form-check-input" type="radio" name="paymentMethod"
                                    value="onlinePayment" checked>
                                <label class="form-check-label" for="onlinePayment">
                                    Online Payment
                                </label>
                            </div>

                            <button type="submit" class="site-btn">PLACE ORDER</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>
<!-- Checkout Section End -->

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
		integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"
		integrity="sha512-37T7leoNS06R80c8Ulq7cdCDU5MNQBwlYoy1TX/WUsLFC2eYNqtKlV0QjH7r8JpG/S0GUMZwebnVFLPd6SU5yg=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>

$("#checkoutForm").validate({
    errorClass: "error",
    rules: {
        firstName: {
            required: true,
            minlength: 3,
        },
        lastName: {
            required: true,
            minlength: 3,
        },
        email: {
            required: true,
            email: true,

        },
        phone: {
            required: true,
            minlength: 10
        },
        country: {
            required: true,
            minlength: 3
        },
       addressLineOne: {
            required: true,
            minlength: 6,
        },
        addressLineTwo: {
            required: true,
            minlength: 6,
        },
        town: {
            required: true,
            minlength: 3,
        },
        state: {
            required: true,
            minlength: 3,
        },
        postcode:{
        required: true,
        minlength: 6,
        }
    }
    
})


$('#checkoutForm').submit((e)=>{
    e.preventDefault()
    $.ajax({
        url:'/checkOut',
        method:'post',
        data:$('#checkoutForm').serialize(),
        success:(response)=>{
            alert(response)
            console.log(response)
            if(response.status){
                location.href='/orderSuccess'
            }
        }
    })
})

</script>